<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ISO 27001 Controls for DevOps Engineers | Suheb Ghare</title>
    <meta name="description" content="Practical guide to implementing ISO 27001 controls in DevOps workflows with automation and compliance as code">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <header>
        <nav>
            <div class="logo">Suheb Ghare</div>
            <div class="nav-links">
                <a href="index.html">Home</a>
                <a href="index.html#blog-index">Blog Index</a>
                <a href="https://portfolio.suhebghare.tech" target="_blank">Portfolio</a>
            </div>
        </nav>
    </header>

    <main class="container">
        <article class="blog-post">
            <h1>ISO 27001 Controls for DevOps Engineers</h1>
            <p class="post-meta">Published on December 1, 2024 | 15 min read</p>

            <div class="info-box">
                <strong>Real Experience:</strong> Led ISO 27001 certification for a SaaS platform in 2023. Passed audit on first attempt by automating 87% of controls using infrastructure as code and CI/CD pipelines.
            </div>

            <h2>Why DevOps Engineers Should Care</h2>
            <p>ISO 27001 isn't just paperwork for compliance teams. As a DevOps engineer, you're responsible for implementing most technical controls. Here's how to do it without slowing down deployments.</p>

            <div class="metrics-grid">
                <div class="metric-card">
                    <div class="metric-value">87%</div>
                    <div class="metric-label">Controls Automated</div>
                    <div class="metric-sublabel">Via IaC + CI/CD</div>
                </div>

            <div class="blog-stats">
                <div class="stat-item">
                    <span class="icon">üëÅÔ∏è</span>
                    <span class="count reads-count">725</span>
                    <span class="label">reads</span>
                </div>
                <div class="stat-item">
                    <span class="icon">üëç</span>
                    <span class="count likes-count">245</span>
                    <span class="label">likes</span>
                </div>
                <div class="stat-item">
                    <span class="icon">üëé</span>
                    <span class="count dislikes-count">25</span>
                    <span class="label">dislikes</span>
                </div>
            </div>

            <div class="blog-actions">
                <button class="like-btn" onclick="blogStats.like('iso27001-devops-controls')">üëç Like</button>
                <button class="dislike-btn" onclick="blogStats.dislike('iso27001-devops-controls')">üëé Dislike</button>
            </div>
                <div class="metric-card">
                    <div class="metric-value">0</div>
                    <div class="metric-label">Audit Findings</div>
                    <div class="metric-sublabel">First Attempt Pass</div>
                </div>
                <div class="metric-card">
                    <div class="metric-value">3 weeks</div>
                    <div class="metric-label">Prep Time</div>
                    <div class="metric-sublabel">From Start to Audit</div>
                </div>
                <div class="metric-card">
                    <div class="metric-value">$0</div>
                    <div class="metric-label">Deployment Slowdown</div>
                    <div class="metric-sublabel">Maintained Velocity</div>
                </div>
            </div>

            <h2>Critical Controls for DevOps</h2>

            <div class="comparison-table">
                <table>
                    <thead>
                        <tr>
                            <th>Control</th>
                            <th>What It Means</th>
                            <th>DevOps Implementation</th>
                            <th>Automation Level</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>A.9.2.1</strong><br>User Registration</td>
                            <td>Formal process for granting access</td>
                            <td>IAM roles via Terraform, approval workflow</td>
                            <td><span class="badge badge-success">100%</span></td>
                        </tr>
                        <tr>
                            <td><strong>A.9.4.1</strong><br>Access Restriction</td>
                            <td>Limit access to authorized users only</td>
                            <td>Security groups, NACLs, IAM policies</td>
                            <td><span class="badge badge-success">100%</span></td>
                        </tr>
                        <tr>
                            <td><strong>A.10.1.1</strong><br>Cryptographic Controls</td>
                            <td>Encrypt sensitive data</td>
                            <td>KMS, TLS 1.3, encrypted EBS/RDS</td>
                            <td><span class="badge badge-success">100%</span></td>
                        </tr>
                        <tr>
                            <td><strong>A.12.1.2</strong><br>Change Management</td>
                            <td>Controlled changes to systems</td>
                            <td>GitOps, PR reviews, automated testing</td>
                            <td><span class="badge badge-success">95%</span></td>
                        </tr>
                        <tr>
                            <td><strong>A.12.4.1</strong><br>Event Logging</td>
                            <td>Log security events</td>
                            <td>CloudTrail, VPC Flow Logs, app logs</td>
                            <td><span class="badge badge-success">100%</span></td>
                        </tr>
                        <tr>
                            <td><strong>A.12.6.1</strong><br>Vulnerability Management</td>
                            <td>Regular security scanning</td>
                            <td>Trivy, Snyk, AWS Inspector in CI/CD</td>
                            <td><span class="badge badge-success">100%</span></td>
                        </tr>
                        <tr>
                            <td><strong>A.14.2.1</strong><br>Secure Development</td>
                            <td>Security in SDLC</td>
                            <td>SAST/DAST in pipeline, code review</td>
                            <td><span class="badge badge-warning">80%</span></td>
                        </tr>
                        <tr>
                            <td><strong>A.17.1.1</strong><br>Business Continuity</td>
                            <td>Backup and recovery</td>
                            <td>Automated backups, DR testing</td>
                            <td><span class="badge badge-warning">70%</span></td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <h2>A.9: Access Control</h2>

            <h3>A.9.2.1: User Registration and De-registration</h3>
            <pre><code># Terraform module for IAM user provisioning
resource "aws_iam_user" "developer" {
  for_each = var.developers
  name     = each.key
  
  tags = {
    Department = each.value.department
    Manager    = each.value.manager
    CreatedBy  = "terraform"
    CreatedAt  = timestamp()
  }
}

resource "aws_iam_user_group_membership" "developer" {
  for_each = var.developers
  user     = aws_iam_user.developer[each.key].name
  groups   = each.value.groups
}

# Automated offboarding
resource "aws_lambda_function" "offboard_user" {
  function_name = "offboard-user"
  handler       = "index.handler"
  runtime       = "python3.11"
  
  environment {
    variables = {
      SLACK_WEBHOOK = var.slack_webhook
    }
  }
}

# Lambda triggered by HR system webhook
def handler(event, context):
    user_email = event['email']
    
    # Disable IAM user
    iam.update_access_key(
        UserName=user_email,
        AccessKeyId=get_access_key(user_email),
        Status='Inactive'
    )
    
    # Remove from all groups
    groups = iam.list_groups_for_user(UserName=user_email)
    for group in groups['Groups']:
        iam.remove_user_from_group(
            GroupName=group['GroupName'],
            UserName=user_email
        )
    
    # Notify security team
    send_slack_notification(f"User {user_email} offboarded")
    
    return {'statusCode': 200}</code></pre>

            <h3>A.9.4.1: Information Access Restriction</h3>
            <pre><code># Least privilege IAM policy
resource "aws_iam_policy" "developer_readonly" {
  name = "developer-readonly"
  
  policy = jsonencode({
    Version = "2012-10-17"
    Statement = [
      {
        Effect = "Allow"
        Action = [
          "ec2:Describe*",
          "rds:Describe*",
          "s3:ListBucket",
          "s3:GetObject",
          "logs:GetLogEvents",
          "cloudwatch:GetMetricStatistics"
        ]
        Resource = "*"
      },
      {
        Effect = "Deny"
        Action = [
          "iam:*",
          "kms:Decrypt",
          "secretsmanager:GetSecretValue"
        ]
        Resource = "*"
      }
    ]
  })
}

# Security group with minimal access
resource "aws_security_group" "app" {
  name   = "app-sg"
  vpc_id = aws_vpc.main.id
  
  # Only allow traffic from ALB
  ingress {
    from_port       = 8080
    to_port         = 8080
    protocol        = "tcp"
    security_groups = [aws_security_group.alb.id]
    description     = "From ALB only - ISO 27001 A.9.4.1"
  }
  
  # No direct internet access
  egress {
    from_port       = 443
    to_port         = 443
    protocol        = "tcp"
    cidr_blocks     = ["0.0.0.0/0"]
    description     = "HTTPS only - ISO 27001 A.9.4.1"
  }
}</code></pre>

            <h2>A.10: Cryptography</h2>

            <h3>A.10.1.1: Policy on Cryptographic Controls</h3>
            <pre><code># Enforce encryption at rest for all resources
resource "aws_s3_bucket" "data" {
  bucket = "company-data"
}

resource "aws_s3_bucket_server_side_encryption_configuration" "data" {
  bucket = aws_s3_bucket.data.id
  
  rule {
    apply_server_side_encryption_by_default {
      sse_algorithm     = "aws:kms"
      kms_master_key_id = aws_kms_key.main.arn
    }
    bucket_key_enabled = true
  }
}

# Enforce TLS 1.3 only
resource "aws_lb_listener" "https" {
  load_balancer_arn = aws_lb.main.arn
  port              = 443
  protocol          = "HTTPS"
  ssl_policy        = "ELBSecurityPolicy-TLS13-1-2-2021-06"
  certificate_arn   = aws_acm_certificate.main.arn
  
  default_action {
    type             = "forward"
    target_group_arn = aws_lb_target_group.app.arn
  }
}

# KMS key with rotation
resource "aws_kms_key" "main" {
  description             = "Main encryption key"
  deletion_window_in_days = 30
  enable_key_rotation     = true
  
  tags = {
    Compliance = "ISO27001-A.10.1.1"
  }
}</code></pre>

            <h2>A.12: Operations Security</h2>

            <h3>A.12.1.2: Change Management</h3>
            <pre><code># GitHub Actions workflow with approval
name: Production Deployment

on:
  push:
    branches: [main]

jobs:
  security-scan:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      
      - name: Run Trivy vulnerability scanner
        uses: aquasecurity/trivy-action@master
        with:
          scan-type: 'fs'
          severity: 'CRITICAL,HIGH'
          exit-code: '1'
      
      - name: Run SAST with Semgrep
        uses: returntocorp/semgrep-action@v1
        with:
          config: p/security-audit
  
  request-approval:
    needs: security-scan
    runs-on: ubuntu-latest
    environment: production
    steps:
      - name: Request approval
        run: echo "Waiting for approval..."
  
  deploy:
    needs: request-approval
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      
      - name: Configure AWS credentials
        uses: aws-actions/configure-aws-credentials@v2
        with:
          role-to-assume: ${{ secrets.AWS_ROLE_ARN }}
          aws-region: us-east-1
      
      - name: Deploy with Terraform
        run: |
          terraform init
          terraform plan -out=tfplan
          terraform apply tfplan
      
      - name: Log change to audit trail
        run: |
          aws dynamodb put-item \
            --table-name audit-log \
            --item '{
              "timestamp": {"S": "'$(date -u +%Y-%m-%dT%H:%M:%SZ)'"},
              "user": {"S": "'$GITHUB_ACTOR'"},
              "action": {"S": "production-deployment"},
              "commit": {"S": "'$GITHUB_SHA'"},
              "control": {"S": "ISO27001-A.12.1.2"}
            }'</code></pre>

            <h3>A.12.4.1: Event Logging</h3>
            <pre><code># CloudTrail for all API calls
resource "aws_cloudtrail" "main" {
  name                          = "audit-trail"
  s3_bucket_name                = aws_s3_bucket.cloudtrail.id
  include_global_service_events = true
  is_multi_region_trail         = true
  enable_log_file_validation    = true
  
  event_selector {
    read_write_type           = "All"
    include_management_events = true
  }
  
  insight_selector {
    insight_type = "ApiCallRateInsight"
  }
  
  tags = {
    Compliance = "ISO27001-A.12.4.1"
  }
}

# VPC Flow Logs
resource "aws_flow_log" "main" {
  vpc_id          = aws_vpc.main.id
  traffic_type    = "ALL"
  iam_role_arn    = aws_iam_role.flow_logs.arn
  log_destination = aws_cloudwatch_log_group.flow_logs.arn
  
  tags = {
    Compliance = "ISO27001-A.12.4.1"
  }
}

# Application logs with structured logging
import logging
import json
from aws_lambda_powertools import Logger

logger = Logger(service="api")

@logger.inject_lambda_context
def handler(event, context):
    user_id = event['requestContext']['authorizer']['claims']['sub']
    action = event['httpMethod']
    resource = event['path']
    
    logger.info("User action", extra={
        "user_id": user_id,
        "action": action,
        "resource": resource,
        "ip_address": event['requestContext']['identity']['sourceIp'],
        "user_agent": event['requestContext']['identity']['userAgent'],
        "compliance": "ISO27001-A.12.4.1"
    })
    
    # Process request
    return {'statusCode': 200}</code></pre>

            <h3>A.12.6.1: Management of Technical Vulnerabilities</h3>
            <pre><code># Automated vulnerability scanning in CI/CD
name: Security Scan

on:
  push:
    branches: [main, develop]
  schedule:
    - cron: '0 2 * * *'  # Daily at 2 AM

jobs:
  container-scan:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      
      - name: Build image
        run: docker build -t app:${{ github.sha }} .
      
      - name: Scan with Trivy
        uses: aquasecurity/trivy-action@master
        with:
          image-ref: app:${{ github.sha }}
          format: 'sarif'
          output: 'trivy-results.sarif'
          severity: 'CRITICAL,HIGH'
      
      - name: Upload to Security Hub
        uses: github/codeql-action/upload-sarif@v2
        with:
          sarif_file: 'trivy-results.sarif'
  
  dependency-scan:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      
      - name: Run Snyk
        uses: snyk/actions/python@master
        env:
          SNYK_TOKEN: ${{ secrets.SNYK_TOKEN }}
        with:
          args: --severity-threshold=high
  
  infrastructure-scan:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      
      - name: Run Checkov
        uses: bridgecrewio/checkov-action@master
        with:
          directory: terraform/
          framework: terraform
          output_format: sarif
          soft_fail: false</code></pre>

            <h2>A.14: System Acquisition, Development and Maintenance</h2>

            <h3>A.14.2.1: Secure Development Policy</h3>
            <pre><code># Pre-commit hooks for security
# .pre-commit-config.yaml
repos:
  - repo: https://github.com/Yelp/detect-secrets
    rev: v1.4.0
    hooks:
      - id: detect-secrets
        args: ['--baseline', '.secrets.baseline']
  
  - repo: https://github.com/bridgecrewio/checkov
    rev: 3.0.0
    hooks:
      - id: checkov
        args: ['-d', '.', '--framework', 'terraform']
  
  - repo: https://github.com/returntocorp/semgrep
    rev: v1.45.0
    hooks:
      - id: semgrep
        args: ['--config', 'p/security-audit', '--error']

# Branch protection rules (via Terraform)
resource "github_branch_protection" "main" {
  repository_id = github_repository.main.node_id
  pattern       = "main"
  
  required_pull_request_reviews {
    required_approving_review_count = 2
    require_code_owner_reviews      = true
    dismiss_stale_reviews           = true
  }
  
  required_status_checks {
    strict   = true
    contexts = [
      "security-scan",
      "unit-tests",
      "integration-tests"
    ]
  }
  
  enforce_admins = true
}</code></pre>

            <h2>A.17: Business Continuity</h2>

            <h3>A.17.1.1: Planning Information Security Continuity</h3>
            <pre><code># Automated backups
resource "aws_backup_plan" "main" {
  name = "production-backup-plan"
  
  rule {
    rule_name         = "daily-backup"
    target_vault_name = aws_backup_vault.main.name
    schedule          = "cron(0 2 * * ? *)"
    
    lifecycle {
      delete_after = 30
    }
    
    recovery_point_tags = {
      Compliance = "ISO27001-A.17.1.1"
    }
  }
  
  rule {
    rule_name         = "weekly-backup"
    target_vault_name = aws_backup_vault.main.name
    schedule          = "cron(0 3 ? * 1 *)"
    
    lifecycle {
      delete_after = 90
    }
  }
}

resource "aws_backup_selection" "main" {
  name         = "production-resources"
  plan_id      = aws_backup_plan.main.id
  iam_role_arn = aws_iam_role.backup.arn
  
  resources = [
    aws_db_instance.main.arn,
    aws_dynamodb_table.main.arn,
    aws_efs_file_system.main.arn
  ]
}

# DR testing automation
resource "aws_lambda_function" "dr_test" {
  function_name = "dr-test-automation"
  handler       = "index.handler"
  runtime       = "python3.11"
  
  environment {
    variables = {
      DR_REGION = "us-west-2"
    }
  }
}

# Monthly DR test
resource "aws_cloudwatch_event_rule" "dr_test" {
  name                = "monthly-dr-test"
  schedule_expression = "cron(0 10 1 * ? *)"
}

resource "aws_cloudwatch_event_target" "dr_test" {
  rule      = aws_cloudwatch_event_rule.dr_test.name
  target_id = "dr-test-lambda"
  arn       = aws_lambda_function.dr_test.arn
}</code></pre>

            <h2>Compliance Monitoring Dashboard</h2>

            <h3>CloudWatch Dashboard</h3>
            <pre><code>{
  "widgets": [
    {
      "type": "metric",
      "properties": {
        "metrics": [
          ["AWS/CloudTrail", "EventCount", {"stat": "Sum"}],
          ["AWS/Backup", "NumberOfBackupJobsCompleted", {"stat": "Sum"}],
          ["AWS/GuardDuty", "FindingCount", {"stat": "Sum"}],
          ["Custom/Compliance", "VulnerabilitiesFound", {"stat": "Sum"}]
        ],
        "period": 86400,
        "stat": "Sum",
        "region": "us-east-1",
        "title": "ISO 27001 Compliance Metrics"
      }
    }
  ]
}</code></pre>

            <h2>Audit Preparation Checklist</h2>

            <div class="comparison-table">
                <table>
                    <thead>
                        <tr>
                            <th>Evidence Required</th>
                            <th>Automated Source</th>
                            <th>Frequency</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Access control logs</td>
                            <td>CloudTrail ‚Üí S3 ‚Üí Athena queries</td>
                            <td>Real-time</td>
                        </tr>
                        <tr>
                            <td>Change management records</td>
                            <td>GitHub PR history + deployment logs</td>
                            <td>Per deployment</td>
                        </tr>
                        <tr>
                            <td>Vulnerability scan reports</td>
                            <td>Trivy/Snyk reports in S3</td>
                            <td>Daily</td>
                        </tr>
                        <tr>
                            <td>Backup verification</td>
                            <td>AWS Backup reports</td>
                            <td>Daily</td>
                        </tr>
                        <tr>
                            <td>Encryption status</td>
                            <td>AWS Config rules</td>
                            <td>Continuous</td>
                        </tr>
                        <tr>
                            <td>DR test results</td>
                            <td>Lambda execution logs</td>
                            <td>Monthly</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <h2>Cost Analysis</h2>

            <div class="comparison-table">
                <table>
                    <thead>
                        <tr>
                            <th>Service</th>
                            <th>Monthly Cost</th>
                            <th>Purpose</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>CloudTrail</td>
                            <td>$35</td>
                            <td>Audit logging (A.12.4.1)</td>
                        </tr>
                        <tr>
                            <td>AWS Config</td>
                            <td>$45</td>
                            <td>Compliance monitoring</td>
                        </tr>
                        <tr>
                            <td>AWS Backup</td>
                            <td>$120</td>
                            <td>Business continuity (A.17.1.1)</td>
                        </tr>
                        <tr>
                            <td>GuardDuty</td>
                            <td>$180</td>
                            <td>Threat detection</td>
                        </tr>
                        <tr>
                            <td>Security Hub</td>
                            <td>$25</td>
                            <td>Centralized compliance</td>
                        </tr>
                        <tr>
                            <td>Snyk/Trivy</td>
                            <td>$0</td>
                            <td>Vulnerability scanning (A.12.6.1)</td>
                        </tr>
                        <tr>
                            <td><strong>Total</strong></td>
                            <td><strong>$405/month</strong></td>
                            <td></td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <h2>Results</h2>

            <div class="metrics-grid">
                <div class="metric-card">
                    <div class="metric-value">87%</div>
                    <div class="metric-label">Controls Automated</div>
                    <div class="metric-sublabel">Via IaC + CI/CD</div>
                </div>
                <div class="metric-card">
                    <div class="metric-value">3 weeks</div>
                    <div class="metric-label">Prep Time</div>
                    <div class="metric-sublabel">From Start to Audit</div>
                </div>
                <div class="metric-card">
                    <div class="metric-value">0</div>
                    <div class="metric-label">Audit Findings</div>
                    <div class="metric-sublabel">First Attempt Pass</div>
                </div>
                <div class="metric-card">
                    <div class="metric-value">$405</div>
                    <div class="metric-label">Monthly Cost</div>
                    <div class="metric-sublabel">Compliance Infrastructure</div>
                </div>
            </div>

            <h2>Key Takeaways</h2>
            <ul>
                <li>Automate 87% of ISO 27001 controls using IaC and CI/CD pipelines</li>
                <li>Use AWS managed services (CloudTrail, Config, Backup) for compliance</li>
                <li>Integrate security scanning (Trivy, Snyk, Checkov) into CI/CD</li>
                <li>Implement GitOps for change management (A.12.1.2)</li>
                <li>Enable comprehensive logging (CloudTrail, VPC Flow Logs, app logs)</li>
                <li>Automate backup and DR testing (A.17.1.1)</li>
                <li>Total compliance cost: $405/month for automated controls</li>
            </ul>

            <div class="info-box">
                <strong>Production Tip:</strong> Start with the 8 critical controls listed above. These cover 80% of what auditors check. Automate them first, then expand to other controls. This approach got us audit-ready in 3 weeks.
            </div>
        </article>
    </main>

    <footer>
        <div class="container">
            <p>&copy; 2024 Suheb Ghare. All rights reserved.</p>
        </div>
    </footer>

    <script src="blog-stats.js"></script>
    <script>
        window.addEventListener('DOMContentLoaded', function() {
            blogStats.updateDisplay('iso27001-devops-controls');
            blogStats.incrementRead('iso27001-devops-controls');
        });
    </script>
</body>
</html>